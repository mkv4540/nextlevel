(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[602],{4714:(e,s,t)=>{Promise.resolve().then(t.bind(t,6437))},6046:(e,s,t)=>{"use strict";var r=t(6658);t.o(r,"useParams")&&t.d(s,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},6437:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>u});var r=t(5155),a=t(9173),n=t(6414),l=t(2115),i=t(6046);function o(e){let{onSubmit:s}=e,[t,a]=(0,l.useState)(""),[n,i]=(0,l.useState)("");return(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,r.jsx)("div",{className:"bg-white rounded-lg w-[400px] shadow-lg",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Enter Your Name"}),(0,r.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!t.trim()){i("Name cannot be empty.");return}i(""),s(t)},children:[(0,r.jsx)("input",{type:"text",placeholder:"Type your name here",className:"w-full p-2 border border-gray-300 rounded text-gray-900 mb-4 focus:outline-none focus:border-gray-400",value:t,onChange:e=>a(e.target.value),"aria-label":"Name input"}),n&&(0,r.jsx)("p",{className:"text-red-500 text-sm mb-4",children:n}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm",onClick:()=>{a(""),i(""),s(null)},children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-black text-white rounded hover:bg-gray-800 text-sm",children:"OK"})]})]})]})})})}let d=e=>{let{timeLeft:s}=e,t=(e=>{let s=Math.floor(e/3600),t=Math.floor(e%3600/60);return{hours:String(s).padStart(2,"0"),minutes:String(t).padStart(2,"0"),seconds:String(e%60).padStart(2,"0")}})(s);return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Time Remaining"}),(0,r.jsxs)("div",{className:"flex justify-center items-center space-x-2",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"bg-blue-500 rounded-lg p-3 w-16",children:(0,r.jsx)("span",{className:"text-2xl font-bold text-white",children:t.hours})}),(0,r.jsx)("span",{className:"text-sm text-gray-600 mt-1",children:"Hours"})]}),(0,r.jsx)("span",{className:"text-2xl font-bold text-blue-500",children:":"}),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"bg-blue-500 rounded-lg p-3 w-16",children:(0,r.jsx)("span",{className:"text-2xl font-bold text-white",children:t.minutes})}),(0,r.jsx)("span",{className:"text-sm text-gray-600 mt-1",children:"Minutes"})]}),(0,r.jsx)("span",{className:"text-2xl font-bold text-blue-500",children:":"}),(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"bg-blue-500 rounded-lg p-3 w-16",children:(0,r.jsx)("span",{className:"text-2xl font-bold text-white",children:t.seconds})}),(0,r.jsx)("span",{className:"text-sm text-gray-600 mt-1",children:"Seconds"})]})]})]}),(0,r.jsx)("div",{className:"mt-4 h-2 bg-gray-200 rounded-full",children:(0,r.jsx)("div",{className:"h-full rounded-full transition-all duration-1000 ".concat(s<300?"bg-red-500":"bg-blue-500"),style:{width:"".concat(s/3600*100,"%")}})})]})};var c=t(926);let u=function(){var e,s;let{isLoaded:t,userId:u}=(0,a.d)(),m=(0,i.useRouter)(),x=(0,i.useSearchParams)().get("videoId"),[h,g]=(0,l.useState)({questions:[],answers:[],markedForReview:[],loading:!0,shuffledOptions:[]}),[b,p]=(0,l.useState)(0),[f,w]=(0,l.useState)(3600),[j,v]=(0,l.useState)(!0),[N,y]=(0,l.useState)(!1),[k,S]=(0,l.useState)(!1),[R,C]=(0,l.useState)(""),[q,A]=(0,l.useState)(""),[P,I]=(0,l.useState)(!1),F=e=>{g(s=>({...s,answers:s.answers.map((s,t)=>t===b?e:s)}))},_=()=>{b<h.questions.length-1&&p(e=>e+1)},O=()=>{let e={videoId:x,answers:h.answers.map((e,s)=>{if(null===e)return{givenAnswer:null,correctAnswer:h.questions[s].correct_answer,isCorrect:!1};let t=h.shuffledOptions[s][e];return{givenAnswer:t,correctAnswer:h.questions[s].correct_answer,isCorrect:t===h.questions[s].correct_answer}}),questions:h.questions.map(e=>({text:e.question,correct_answer:e.correct_answer})),markedForReview:h.markedForReview,timeSpent:3600-f};localStorage.setItem("quizResults",JSON.stringify(e)),I(!0)};if((0,l.useEffect)(()=>{if(!x&&!j){console.error("No video ID provided"),m.push("/");return}},[x,j,m]),(0,l.useEffect)(()=>{j||async function(){try{let e=await fetch("/api/transcript",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({videoId:x})});if(!e.ok)throw Error("Transcript fetch error: ".concat(e.status));let s=await e.json();console.log("Transcript Data:",s);let t=s.transcript,r=await fetch("/api/generate-quiz",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:t})});if(!r.ok)throw Error("Quiz fetch error: ".concat(r.status));let a=await r.json();console.log("Quiz Data:",a);let n=a.questions.map((e,s)=>({question:e,correct_answer:a.answers[s],incorrect_answers:a.options[s].filter(e=>e!==a.answers[s])})),l=a.options;g({questions:n,answers:Array(n.length).fill(null),markedForReview:Array(n.length).fill(!1),loading:!1,shuffledOptions:l})}catch(e){console.error("Error fetching questions:",e),g(e=>({...e,loading:!1}))}}()},[j]),(0,l.useEffect)(()=>{if(!j&&f>0){let e=setInterval(()=>{w(s=>s<=1?(clearInterval(e),O(),0):s-1)},1e3);return()=>clearInterval(e)}},[j,f]),(0,l.useEffect)(()=>{P&&m.push("/result")},[P,m]),!t||!x)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})});if(!u)return(0,r.jsx)(n.W5,{});if(j)return(0,r.jsx)(o,{onSubmit:e=>{console.log("Submitted Name:",e),e?v(!1):m.push("/")}});if(h.loading)return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})});let T=e=>({answered:e.answers.filter(e=>null!==e).length,notAnswered:e.answers.filter(e=>null===e).length,markedForReview:e.markedForReview.filter(e=>e).length,answeredAndMarked:e.answers.filter((s,t)=>null!==s&&e.markedForReview[t]).length,notVisited:e.answers.filter((s,t)=>null===s&&!e.markedForReview[t]).length});return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto p-4",children:[(0,r.jsx)(d,{timeLeft:f}),(0,r.jsx)("div",{children:(0,r.jsx)("button",{onClick:()=>S(!0),className:"mt-4 px-6 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Report Question"})})]})}),k&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Report Question Problem"}),(0,r.jsxs)("form",{children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Reason:"}),(0,r.jsxs)("div",{className:"space-y-2 text-gray-800",children:[(0,r.jsxs)("label",{children:[(0,r.jsx)("input",{type:"radio",name:"reportReason",value:"I think the answer is wrong",onChange:e=>C(e.target.value),className:"mr-2"}),"I think the answer is wrong"]}),(0,r.jsxs)("label",{className:"flex item-center",children:[(0,r.jsx)("input",{type:"radio",name:"reportReason",value:"There are multiple correct answers",onChange:e=>C(e.target.value),className:"mr-2"}),"There are multiple correct answers"]}),(0,r.jsxs)("label",{className:"flex item-center",children:[(0,r.jsx)("input",{type:"radio",name:"reportReason",value:"There is a typing error",onChange:e=>C(e.target.value),className:"mr-2"}),"There is a typing error"]}),(0,r.jsxs)("label",{className:"flex item-center",children:[(0,r.jsx)("input",{type:"radio",name:"reportReason",value:"Image or text is not displayed properly",onChange:e=>C(e.target.value),className:"mr-2"}),"Image or comprehension text is not displaying properly"]}),(0,r.jsxs)("label",{className:"flex item-center",children:[(0,r.jsx)("input",{type:"radio",name:"reportReason",value:"Something else",onChange:e=>C(e.target.value),className:"mr-2"}),"Something else (please specify below)"]})]})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 font-medium mb-2",children:"Additional Information:"}),(0,r.jsx)("textarea",{value:q,onChange:e=>A(e.target.value),className:"w-full border rounded p-2 text-gray-800",rows:"4"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)("button",{onClick:()=>S(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Close"}),(0,r.jsx)("button",{onClick:()=>{console.log("Report Submitted:",{reason:R,additionalInfo:q}),S(!1),C(""),A("")},className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Send Report"})]})]})}),(0,r.jsx)("main",{className:"max-w-7xl mx-auto p-4",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)("section",{className:"md:col-span-2",children:(0,r.jsxs)("div",{className:"bg-white border rounded-lg p-6",children:[(0,r.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 mb-4",children:["Question Number ",b+1]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)("p",{className:"text-gray-700",children:(0,c.decode)((null===(e=h.questions[b])||void 0===e?void 0:e.question)||"")})}),(0,r.jsx)("div",{className:"space-y-3",children:null===(s=h.shuffledOptions[b])||void 0===s?void 0:s.map((e,s)=>(0,r.jsx)("button",{onClick:()=>F(s),className:"w-full text-left p-4 rounded border transition-all\n                                ".concat(h.answers[b]===s?"border-blue-500 bg-blue-50 text-black":"border-gray-200 hover:border-blue-300 hover:bg-gray-50 text-black"),children:(0,c.decode)(e)},s))}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>{b>0&&p(e=>e-1)},className:"px-6 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Previous"}),(0,r.jsx)("button",{onClick:_,className:"px-6 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Next"}),(0,r.jsx)("button",{onClick:()=>{g(e=>({...e,markedForReview:e.markedForReview.map((e,s)=>s===b?!e:e)})),_()},className:"px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Mark for Review & Next"}),(0,r.jsx)("button",{onClick:()=>{null!==h.answers[b]&&_()},className:"px-6 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Save & Next"})]})]})}),(0,r.jsxs)("aside",{className:"bg-white border rounded-lg p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Question Palette"}),(0,r.jsx)("div",{className:"grid grid-cols-6 gap-2 mb-6",children:h.questions.map((e,s)=>{let t=null!==h.answers[s],a=h.markedForReview[s],n=s===b,l="h-10 w-full rounded text-sm font-medium ";return t&&a?l+="bg-purple-500 text-white":t?l+="bg-green-500 text-white":a?l+="bg-blue-500 text-white":n?l+="bg-yellow-500 text-black":l+="bg-gray-200 text-black",(0,r.jsx)("button",{onClick:()=>p(s),className:l,children:s+1},s)})}),(0,r.jsx)("div",{className:"space-y-2 border-t pt-4",children:[{label:"Answered",color:"bg-green-500",count:T(h).answered},{label:"Not Answered",color:"bg-red-500",count:T(h).notAnswered},{label:"Marked for Review",color:"bg-blue-500",count:T(h).markedForReview},{label:"Answered & Marked for Review",color:"bg-purple-500",count:T(h).answeredAndMarked}].map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-4 h-4 ".concat(e.color," rounded")}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:[e.label,": ",e.count]})]},s))}),(0,r.jsx)("button",{onClick:()=>y(!0),className:"w-full mt-6 py-3 bg-red-500 text-white rounded hover:bg-red-600",children:"Submit Quiz"})]})]})}),N&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Submit Quiz?"}),(0,r.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,r.jsxs)("p",{className:"text-gray-600",children:["Answered Questions: ",T(h).answered]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Not Attempted Questions: ",T(h).notAnswered]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Questions Marked for Review: ",T(h).markedForReview]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)("button",{onClick:()=>y(!1),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200",children:"Cancel"}),(0,r.jsx)("button",{onClick:O,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Submit"})]})]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[173,926,441,517,120],()=>s(4714)),_N_E=e.O()}]);